<!-- Grid-Container im Body -->
<div id="grid" style="display:grid;gap:6px;grid-template-columns:repeat(7,1fr);grid-auto-rows:1fr;height:100vh;"></div>

<script>
  // 28 Symbole (deine Reihenfolge)
  const symbols = [
    "OANDA:EURUSD","OANDA:GBPUSD","OANDA:AUDUSD","OANDA:NZDUSD","OANDA:USDCHF","OANDA:USDJPY","OANDA:USDCAD",
    "OANDA:EURGBP","OANDA:EURJPY","OANDA:EURAUD","OANDA:EURNZD","OANDA:EURCAD","OANDA:EURCHF",
    "OANDA:GBPJPY","OANDA:GBPAUD","OANDA:GBPNZD","OANDA:GBPCAD","OANDA:GBPCHF",
    "OANDA:AUDNZD","OANDA:AUDCAD","OANDA:AUDJPY","OANDA:AUDCHF",
    "OANDA:NZDJPY","OANDA:NZDCAD","OANDA:NZDCHF",
    "OANDA:CADJPY","OANDA:CADCHF","OANDA:CHFJPY"
  ];

  const baseConfig = {
    allow_symbol_change: true,
    calendar: false,
    details: false,
    hide_side_toolbar: true,
    hide_top_toolbar: false,
    hide_legend: false,
    hide_volume: false,
    hotlist: false,
    interval: "15",
    locale: "de_DE",
    save_image: true,
    style: "1",
    theme: "dark",
    timezone: "Europe/Berlin",
    backgroundColor: "#0F0F0F",
    gridColor: "rgba(242,242,242,0.06)",
    watchlist: [],
    withdateranges: false,
    compareSymbols: [],
    studies: [],
    autosize: true
  };

  const grid = document.getElementById('grid');

  function addChart(symbol){
    const outer = document.createElement('div');
    outer.className = 'chart';
    const wrap = document.createElement('div');
    wrap.className = 'tradingview-widget-container';
    wrap.style.height = '100%';
    wrap.style.width = '100%';
    const widget = document.createElement('div');
    widget.className = 'tradingview-widget-container__widget';
    widget.style.height = '100%';
    widget.style.width = '100%';

    const s = document.createElement('script');
    s.async = true;
    s.type = 'text/javascript';
    s.src = 'https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js';
    s.innerHTML = JSON.stringify({ ...baseConfig, symbol });

    wrap.appendChild(widget);
    wrap.appendChild(s);
    outer.appendChild(wrap);
    grid.appendChild(outer);
  }

  // sequentiell mit kleinem Abstand + einfachem Retry
  async function loadAll(){
    for (let i=0; i<symbols.length; i++){
      try {
        addChart(symbols[i]);
      } catch(e){
        // Retry nach 400ms falls irgendwas schiefging
        await new Promise(r=>setTimeout(r,400));
        addChart(symbols[i]);
      }
      // Abstand zwischen Inits, damit Verbindungen/GPU nicht spiken
      await new Promise(r=>setTimeout(r,250));
    }
  }

  loadAll();
</script>
